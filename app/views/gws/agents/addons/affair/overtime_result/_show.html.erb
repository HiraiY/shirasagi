<% return if @item.workflow_state != "approve" %>

<%
  def format_minute(minute)
    (minute.to_i > 0) ? "#{minute / 60}:#{format("%02d", (minute % 60))}" : "--:--"
  end
%>

<dl class="see addon-gws-affair-overtime_result">
  <% if @item.day_results.present? %>
    <table class="index overtime-results">
      <thead>
        <tr>
          <th class="start-at" rowspan="2"><%= @item.result.t(:start_at) %></th>
          <th class="end-at" rowspan="2"><%= @item.result.t(:end_at) %></th>
          <th class="time" colspan="3"><%= "時間外（勤務日）" %></th>
          <th class="time" colspan="2"><%= "時間外（週休日・休日）" %></th>
          <th class="time" rowspan="2"><%= "同一週内振替" %></th>
          <th class="time" rowspan="2"><%= "同一週外振替" %></th>
          <th class="time" rowspan="2"><%= "休憩" %></th>
        </tr>
        <tr>
          <th class="time"><%=br "普通\n125/100" %></th>
          <th class="time"><%=br "深夜\n150/100" %></th>
          <th class="time"><%=br "時短\n100/100" %></th>
          <th class="time"><%=br "普通\n135/100" %></th>
          <th class="time"><%=br "深夜\n160/100" %></th>
        </tr>
      </thead>
      <tbody class="items">
        <% @item.day_results.each do |day_result| %>
          <tr class="item">
            <td class="start-at"><%= day_result.start_at.strftime("%Y/%m/%d %H:%M") %></td>
            <td class="end-at"><%= day_result.end_at.strftime("%Y/%m/%d %H:%M") %></td>
            <td class="time"><%= format_minute(day_result.duty_day_time_minute) %></td>
            <td class="time"><%= format_minute(day_result.duty_night_time_minute) %></td>
            <td class="time"><%= format_minute(day_result.duty_day_in_work_time_minute) %></td>
            <td class="time"><%= format_minute(day_result.leave_day_time_minute) %></td>
            <td class="time"><%= format_minute(day_result.leave_night_time_minute) %></td>
            <td class="time"><%= format_minute(day_result.week_in_compensatory_minute) %></td>
            <td class="time"><%= format_minute(day_result.week_out_compensatory_minute) %></td>
            <td class="time"><%= format_minute(day_result.break_time_minute) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <%= link_to t("gws/affair.links.edit_results"), edit_gws_affair_overtime_result_path(id: @item.id, ref: request.path), class: "ajax-box" %>
  <% else %>
    <%= link_to t("gws/affair.links.set_results"), edit_gws_affair_overtime_result_path(id: @item.id, ref: request.path), class: "ajax-box" %>
  <% end %>
</dl>
