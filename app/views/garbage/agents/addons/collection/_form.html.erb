<%= jquery do %>
  $(".garbage-type .add-info").on('click', function () {
    var dd, dt;
    if ($(".garbage-type").length < 10) {
      dd = $(".garbage-type dd:last").clone(true);
      dt = $(".garbage-type dt:last").clone(true);
      dd.find("input").val("");
      dd.find("input").val("");
      dt.find("input").val("");
      dt.find("input").val("");
      $(".garbage-type dd:last").after(dt);
      $(".garbage-type dt:last").after(dd);
    }
    return false;
  });
  $(".garbage-type .clear").on('click', function () {
    var dd, dt;
    dd = $(this).closest("dd");
    dt = dd.prev("dt");
    if ($(".garbage-type dt").length > 2) {
      if (dt.find("input").val() !== "" || dd.find("input").val() !== "") {
        if (confirm('<%= t("cms.confirm.delete_item") %>')) {
          dt.remove();
          dd.remove();
        }
      } else {
        dt.remove();
        dd.remove();
      }
    } else {
      if (dt.find("input").val() !== "" || dd.find("input").val() !== "") {
        if (confirm('<%= t("cms.confirm.delete_item") %>')) {
          dt.find("input").val("");
          dd.find("input").val("");
        }
      } else {
        dt.find("input").val("");
        dd.find("input").val("");
      }
      return false;
    }
  });
<% end %>

<dl class="see mod-garbage-collection">
  <dt><%= @model.t :center %><%= @model.tt :center %></dt>
  <dd><%= f.text_field :center %></dd>
</dl>
<dl class="see garbage-type">
  <dt class="field"><%= @item.t :field %><%= @item.tt :field %></dt>
  <dd class="value"><%= @item.t :value %><%= @item.tt :value %></dd>

  <% category_options = @cur_node.becomes_with_route.parent.try(:becomes_with_route).st_categories.pluck(:name) %>
  <% if @item.garbage_type.blank? %>
    <dt><%= select_tag "item[garbage_type][][field]", options_for_select(category_options), include_blank: true %></dt>
    <dd>
      <%= text_field_tag "item[garbage_type][][value]", nil, placeholder: "例) 月1" %>
      <%= button_tag @item.t(:del_info), {type: :button, class: "clear btn"} %>
    </dd>
  <% end %>
  <% @item.garbage_type.each do |info| %>
    <dt><%= select_tag "item[garbage_type][][field]", options_for_select(category_options, info[:field]), include_blank: true %></dt>
    <dd>
      <%= text_field_tag "item[garbage_type][][value]", info[:value] %>
      <%= button_tag @item.t(:del_info), {type: :button, class: "clear btn"} %>
    </dd>
  <% end %>

  <%= button_tag @item.t(:add_info), {type: :button, class: "add-info btn"} %>
</dl>
